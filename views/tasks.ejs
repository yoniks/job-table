<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>

       <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>List work</title>
  <link href="/css/tasks.css"  rel="stylesheet">
  
 
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100;1,900&display=swap" rel="stylesheet">


    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>







</head>
<body >


<h1 style="text-align:center;margin-top:1%">our tasks</h1>

<section id="section0" >
<div class="row">
<div class="col-lg-12">
<div class="progress" >
  <div class="progress-bar progress-bar-striped bg-success" role="progressbar"
  style="width: <%= percents %>%" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100"> <%=percents%>%</div>
</div>
</div><!-- lg-->
</div><!-- row-->
</section>



<section id="section1">



 
<div class="row" >

 
  <div class="col-lg-12" style="padding-top: 1%;">
    <p style="text-align:center;padding-bottom:1%">id: <%=idTask%> </p>
    </div>


   

    <div class="dropdown">

    
      <div class="col-lg-2" style="padding:0.5%">
      <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
        Projects
      </button>
      

      <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
    
          <% if(idExistPrjs!=null||idExistPrjs.lenght>0) { %>
        <% idExistPrjs.forEach(function(id_table){ %>
        <li><a class="dropdown-item" href="/task/<%=id_table%>" > <%=id_table%> </a></li>

        <%});%>

        <%}%>
     
      </ul>
      </div>
    </div>







  <form action="/task/:id_prj"  method="post"><!--action   ***-->


    <div class="col-lg-2" style="padding:0.5%">
    <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#createTask" data-bs-whatever="@mdo">Create Task</button>
    </div>
  
    <div class="modal fade" id="createTask" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">New message</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form>
              <div class="mb-3">
                <label for="recipient-name" class="col-form-label">Recipient:</label>
                <input type="text" name="idTaskCreated"  class="form-control" id="recipient-name" placeholder="create id">
              </div>
              <div class="mb-3">
                <input type="text" name="idColumn"  class="form-control" id="recipient-name" placeholder="Columns">
              </div>
              <div class="mb-3">
                <input type="text" name="idRow" class="form-control" id="recipient-name" placeholder="Rows">
              </div>
              <div class="mb-3">
                <textarea class="form-control" id="message-text" placeholder="about your project"></textarea>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <button type="submit" class="btn btn-primary">ok</button>
          </div>
        </div>
      </div>
    </div>




  </form>



  <form action="/task/<%=idTask%>?_method=PATCH"  method="post"><!--action   ***-->
     
    <div class="col-lg-2" style="padding:0.5%">

    <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#editTask" data-bs-whatever="@mdo">Task Edit</button>
    </div>
  
    <div class="modal fade" id="editTask" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">New message</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form>
              <div class="mb-3">
        
                <input type="text" name="idTaskCreated" class="form-control" id="recipient-name" value="<%=idTask%>" placeholder="create id">
              </div>
              <div class="mb-3">
                <input type="text" name="idColumn"  class="form-control" id="recipient-name" placeholder="Columns">
              </div>
              <div class="mb-3">
                <input type="text" name="idRow" class="form-control" id="recipient-name" placeholder="Rows">
              </div>
           
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <button type="submit" class="btn btn-primary" >ok</button>
          </div>
        </div>
      </div>
    </div>

    </form>



<form action="/task/<%=idTask%>?_method=DELETE"  method="post"><!--action   ***-->
 
  <div class="col-lg-2" style="padding:0.5%">
  
    <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#deleteTask" data-bs-whatever="@">Delete Task</button>

  </div>

 

  
  <div class="modal fade" id="deleteTask" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">New message</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form>
            <div class="mb-3">
      
              <input type="text" name="deleteTaskbyId" class="form-control" id="recipient-name" value="<%=idTask%>" placeholder="write id">
            </div>
           
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="submit" class="btn btn-primary" >ok</button>
        </div>
      </div>
    </div>
  </div>


 
  </form>

 
</div><!--row  from>-->



<%if(ListTask!=null){%><!--if empty return true  -->
<div class="row">
<%let c=12/columns%>

<% ListTask.forEach(function(task){ %><!--list obj-->

<div class="col-lg-<%=c%>">
<!-- for-->


<div class="input-group mb-3">
  <div class="input-group-text">

    <form action="/task/<%=idTask%>/<%=task._id%>"  method="post">
    <%if(task.isSelected){%>
  

         <input type="checkbox"  class="form-check-input mt-0"  value="<%=task._id%>"
       onchange="this.form.submit()" checked='checked'>
       </input>
     

    <%}else if(!task.isSelected){%><!-- aria-label="Text input with checkbox" -->
      <!--onchange='handleChange(this);' the behavior  call to fun in javaScript if(!task.isSelected)-->
    
        <input type="checkbox" class="form-check-input mt-0"   value="<%=task._id%>"
        onchange="this.form.submit()"   ></input>
  
     <%}%>
    </form> 

   </div>

  <input type="text" name="nameTask" class="form-control" value="<%=task._id%>">


</div>




</div>

<%});%>


</did>

<%}%>  


<p class="note-text" >Note: add col and row to see result,
    Array tasks is limit to 5 columns, and you can't change the num Array
    to smaller if checkbox selected is true,</p>


</section>












<%- include("partials/footer"); -%>
